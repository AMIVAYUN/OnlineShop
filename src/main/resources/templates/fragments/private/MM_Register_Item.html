<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org" lang="ko">

<head>
    <meta charset="UTF-8">
    <title>제품 등록</title>
    <meta name="_csrf" th:content="${_csrf.token}">
    <meta name="_csrf_header" th:content="${_csrf.headerName}">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../../css/register_item.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Do+Hyeon&family=Jua&display=swap" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    
</head>
<body>
    <!--<form method="post" action="/api/v2/register-item.do" enctype="multipart/form-data">-->
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
        <input type="text" name="name"id="name" placeholder="상품 이름"/><br>
        <input type="number" name="price"id="price" placeholder="가격"/></br>
        <input type="number" name="StockQuantity" id="StockQuantity" placeholder="재고 수량"/></br>
        <input type="number" name="Weight" id="Weight" placeholder="무게"/></br>
        <input type="text" name="Description" id="Description" placeholder="상품 설명"/></br>
        <input type="text" name="MadeIn" id="MadeIn" placeholder="제조 국가"/></br>
        <input type="text" name="ManufacturedCompany"id="ManufacturedCompany" placeholder="제조사"/></br>
        <input type="file" id="input-image" name="file"style="height:50px;"/></br>
        
        <select name="dtype" >
            <option name="L">누수탐지기</option>
            <option name="D">드릴</option>
            <option name="E">내시경</option>
            <option name="G">글라인더</option>
            <option name="H">해머</option>
            <option name="C">커터</option>
            <option name="N">니퍼</option>
            <option name="S">하수관 청소기</option>
            <option name="W">렌치</option>
            <option name="ETC">기타</option>
            
            
          </select></br>
          <button type="submit" value="결과 확인">전송</button>



    <script>
        const csrfToken = $('meta[name="_csrf"]').attr('content');
        var formData=new FormData();
        var alph=$("#input-image")
        data=alph[0].files[0];
        if($("#input-image").length){
            formData.append('file',data);
        }
            let obj={
                "name":$("#name").val(),
                "description": $("#Description").val(),
                "price": selected[0]['item_price'],
                "dtype":selected[0]['item_type'],
                "stockquantity":selected[0]['item_stock'],
                "manufacturedcompany":selected[0]['item_company'],
                "madein":selected[0]['item_country'],
                "weight":selected[0]['item_weight']
            }
            formData.append('body',JSON.stringify(obj))
            updateItemSequence(selected[0].item_id,formData);

        }
        async function updateItemSequence(id,formData){
            var url="/admin/manage/items/"+id+"/update-item.do"

            await fetch(url,{method:"put",headers:{'X-CSRF-TOKEN': csrfToken},body:formData}).then(response => response.text()).then(
                (res) => {
                    alert(res);
                    location.reload();
                }
            )}
    </script>
</body>
</html>